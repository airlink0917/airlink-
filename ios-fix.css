/* iOS専用修正CSS - テーブルレイアウトによる完全同期 */

@media (max-width: 768px) {
    /* カレンダー全体をテーブルレイアウトに変更 */
    .vertical-calendar {
        display: table;
        width: 100%;
        table-layout: fixed;
        border-collapse: collapse;
    }

    .vertical-calendar-grid {
        display: table-row-group;
    }

    /* スタッフヘッダー行 */
    .staff-header {
        display: table-row;
        width: 100%;
    }

    .staff-inputs {
        display: table;
        width: 100%;
        table-layout: fixed;
    }

    .date-header-cell {
        display: table-cell;
        width: 50px !important;
        min-width: 50px !important;
        max-width: 50px !important;
    }

    .staff-input-cell {
        display: table-cell;
        width: auto;
    }

    /* 各日付行 */
    .date-row {
        display: table;
        width: 100%;
        table-layout: fixed;
    }

    .date-cell {
        display: table-cell;
        width: 50px !important;
        min-width: 50px !important;
        max-width: 50px !important;
        vertical-align: middle;
    }

    .events-grid {
        display: table-cell;
        width: auto;
    }

    .event-cell {
        display: inline-block;
        width: calc((100vw - 50px) / var(--staff-count, 9)) !important;
        min-width: 50px;
        vertical-align: top;
    }

    /* スタッフ入力欄の幅を自動調整 */
    .staff-input {
        width: 100% !important;
        box-sizing: border-box;
    }

    /* ボーダーの調整 */
    .date-cell,
    .date-header-cell {
        border-right: 2px solid #667eea !important;
    }

    .staff-input-cell,
    .event-cell {
        border-right: 1px solid #e2e8f0 !important;
        border-left: none !important;
    }

    /* 最後のセルのボーダーを削除 */
    .staff-input-cell:last-child,
    .event-cell:last-child {
        border-right: none !important;
    }
}

/* iPhone専用の追加修正 */
@supports (-webkit-touch-callout: none) {
    @media (max-width: 768px) {
        /* スタッフ数に応じた動的幅計算 */
        :root {
            --cell-width: calc((100vw - 50px) / var(--staff-count, 9));
        }

        .staff-input-cell {
            width: var(--cell-width) !important;
            min-width: var(--cell-width) !important;
            max-width: var(--cell-width) !important;
        }

        .event-cell {
            width: var(--cell-width) !important;
            min-width: var(--cell-width) !important;
            max-width: var(--cell-width) !important;
        }

        /* グリッドの代わりにフレックスボックスを使用 */
        .events-grid {
            display: flex !important;
            flex-wrap: nowrap !important;
            width: calc(100vw - 50px) !important;
        }

        .staff-inputs {
            display: flex !important;
            width: 100vw !important;
        }

        /* パディングとマージンを完全にリセット */
        .vertical-calendar,
        .vertical-calendar-grid,
        .staff-header,
        .date-row,
        .staff-inputs,
        .events-grid {
            padding: 0 !important;
            margin: 0 !important;
        }

        /* コンテナの幅を制限 */
        .calendar-container {
            width: 100vw !important;
            max-width: 100vw !important;
            padding: 0 !important;
            margin: 0 !important;
            overflow-x: auto !important;
        }

        .container {
            padding: 0 !important;
            margin: 0 !important;
            width: 100vw !important;
            max-width: 100vw !important;
        }

        /* スクロール可能エリアの設定 */
        .main-content {
            width: 100vw !important;
            overflow-x: auto !important;
            -webkit-overflow-scrolling: touch !important;
        }
    }
}